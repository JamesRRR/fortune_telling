<view class="container">
  <!-- æ·»åŠ è£…é¥°å…ƒç´  -->
  <view class="decoration decoration-1">âœ¨</view>
  <view class="decoration decoration-2">ğŸŒŸ</view>
  <view class="decoration decoration-3">â­</view>
  <view class="decoration decoration-4">âœ¨</view>

  <!-- ä¸“å®¶é€‰æ‹©åŒºåŸŸ -->
  <view class="expert-selection" wx:if="{{!selectedExpert && !skippedSelection}}">
    <view class="section-title">é€‰æ‹©å¿ƒä»ªçš„å¤§å¸ˆ</view>
    <scroll-view scroll-y="true" class="experts-list">
      <view class="expert-card" 
            wx:for="{{experts}}" 
            wx:key="id"
            bindtap="selectExpert"
            data-expert="{{item}}">
        <view class="expert-avatar">{{item.avatar}}</view>
        <view class="expert-info">
          <view class="expert-name">{{item.name}}</view>
          <view class="expert-desc">{{item.description}}</view>
          <view class="expert-specialties">
            <text class="specialty" wx:for="{{item.specialties}}" wx:key="*this">{{item}}</text>
          </view>
        </view>
      </view>
      <view class="skip-selection" bindtap="skipExpertSelection">
        æš‚æ—¶ä¸é€‰ï¼Œç›´æ¥å’¨è¯¢ â†’
      </view>
    </scroll-view>
  </view>

  <!-- èŠå¤©åŒºåŸŸ -->
  <block wx:if="{{selectedExpert || skippedSelection}}">
    <view class="back-to-selection" bindtap="backToSelection">
      <text class="back-icon">â†</text>
    </view>

    <view class="header">
      <view class="expert-info" wx:if="{{selectedExpert}}">
        <view class="expert-avatar">{{selectedExpert.avatar}}</view>
        <view class="expert-name">{{selectedExpert.name}}</view>
      </view>
      <text class="title" wx:else>âœ¨ç®—å‘½å°åŠ©æ‰‹âœ¨</text>
      <text class="subtitle">æ¥é—®é—®ä½ çš„æœªæ¥å§~</text>
    </view>

    <view class="chat-container">
      <scroll-view scroll-y="true" class="chat-list" scroll-into-view="{{scrollToView}}">
        <block wx:for="{{messages}}" wx:key="index">
          <view class="message {{item.type}}" id="msg-{{index}}">
            <view class="avatar {{item.type}}-avatar">
              {{item.type === 'user' ? 'æˆ‘' : (selectedExpert ? selectedExpert.avatar : 'âœ¨')}}
            </view>
            <view class="message-content">{{item.content}}</view>
          </view>
        </block>
        <view class="loading" wx:if="{{isLoading}}">
          <view class="loading-dots">
            <view class="dot"></view>
            <view class="dot"></view>
            <view class="dot"></view>
          </view>
        </view>
      </scroll-view>
    </view>
    
    <view class="input-container">
      <input class="input-field" 
             type="text" 
             value="{{inputMessage}}"
             bindinput="bindinput"
             placeholder="å’Œæˆ‘èŠèŠå§~"
             confirm-type="send"
             bindconfirm="sendMessage"/>
      <button class="send-btn" bindtap="sendMessage">
        <text class="send-icon">âœ¨</text>
      </button>
    </view>
  </block>
</view>